![[Pasted image 20220721110105.png]]

![[Pasted image 20220721110209.png]]


![[Pasted image 20220721110237.png]]

![[Pasted image 20220721110318.png]]

### Multi-Index
its more complicated than it needs to be, but it guarntees that memory is not overloaded with needless unique values

a level means an index column

levels = list of lists. each list is for a level. it contains the __unique__ values in that level. interact with either name or 
labels = list of list. each list is again for a level. but it runs for all the rows and it instead contains the index numbers of the value in each cell.
names = name is totallydiffent, its just the names of the index levels.



### Views vs Copies
df.loc[:,"Colname"] or   returns a view, which can be viewed to set the values.

df["Colname"] returns a copy
(df_after.xs(key=iso_no, level="Isotope Number")) returns a copy

### Make first 2 columns multiindex

https://stackoverflow.com/questions/44442831/create-multiindex-from-existing-dataframe


### Create a new df from operations on another df



An 'axis' is a row or a column
Axis 0 means  'Columns' 
Axis 1  means 'Rows' 


Convert non-numeric values to NaN
df = df.apply(pd.to_numeric, errors='coerce')

Drop Rows with a NaN

## Index vs Columns
df.index means the index rows names object
df.columns means the column names object


## How to write NaN
float("NaN")


## Single Indexes
Identifying multiple columns:
df.set_index([list col names], in_place=True )

Set first column as index
```python
df.set_index(df.columns[0])
```


### Make a certain column number the index


## Multi indexes
### Make a Multi Index by splitting the column names
Identifying by the name of the column split by a space
t = [tuple(c.split(" ")) for c in df.columns]  
df.columns = pd.MultiIndex.from_tuples(t)

### or by splitting the Index rows names
t = 

### Make a multi index by creating a nested dictionary with Keys as tuples
dct = {("a","b") : dct1 ....}


### Transpose Multi Indexes
	# move row indexers above columns
	df.unstack(level=0)
	or:
	df.unstack(level="name")

	# move column indexers to rows
	df.stack(level=0) 
	df.stack(level="name")

Row indexers: level 0 is left, level n is right
Column indexers level 0 is top, level n is bottom  

### Drop a multindex  level
 #### Axis
 0 = columns
 1 = rows
 But seems to be opposite for this
 
```python
# Drop last column header, axis 
df.droplevel(level=-1, axis=1)

# Drop last row header
df.droplevel(level=-1, axis=0)

```


### Filter Columns by multi-index
https://stackoverflow.com/questions/53927460/select-rows-in-pandas-multiindex-dataframe
With two indexes:
df_after.loc[(slice(None),"92235"), :]

Remember that `[]` and `()` have special meaning when dealing with a `MultiIndex` object:
https://stackoverflow.com/questions/18470323/selecting-columns-from-pandas-multiindex 


> (...) a tuple is interpreted as one **multi-level** key
> 
> (...) a list is used to specify several keys [on the **same level**]
> 
> (...) a tuple of lists refer to several values within a level


```python
data.loc[:, (slice(None), ["a", "b"])]
```

Filter Rows within a multiindex column
https://stackoverflow.com/questions/25224545/filtering-multiple-items-in-a-multi-index-python-panda-dataframe
`df[df.index.get_level_values('PBL_AWI').isin(['Lake', 'River', 'Upland'])]`


### Rename Indexes
USe df.rename_axis: 
- Single index: mapper + axis or;
- Multi index: index)

df.rename_axis(mapper="Scenario", axis=1, inplace=True)  

df.rename_axis(index=(list(df_before.index.names)[:-1]) + ["Scenario"], inplace=True)

### Drop Duplicates
Drop the rows with duplicate values

	df.drop_duplicates(inplace=True, ignore_index=False)

Ignore indexflag drops the index too

Drop the rows with duplicate indexes, even though they may not contain duplicate values

	df_after = df_after[~df_after.index.duplicated(keep='first')]
	

## Print to table

> [StackOverflow](https://stackoverflow.com/a/59574470/12679118)

```python
import matplotlib.pyplot as plt
from matplotlib.backends.backend_pdf import PdfPages

```python
the_table = ax.table(cellText=df.values,colLabels=df.columns,loc='center')

#https://stackoverflow.com/questions/4042192/reduce-left-and-right-margins-in-matplotlib-plot
pp = PdfPages("foo.pdf")
pp.savefig(fig, bbox_inches='tight')
pp.close()
```
```